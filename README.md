# ü§ñ Kripto X…ôb…ôr Botu (Crypto News Bot)

Real-time kripto x…ôb…ôrl…ôrini AI analizi v…ô g√ºnl√ºk √∂zet il…ô birlikd…ô payla≈üan akƒ±llƒ± Telegram bot.

## üéØ ∆èsas Funksiyalar

- **üì∞ Real-time x…ôb…ôr payla≈üƒ±mƒ±**: CoinDesk, The Block, Crypto News, NewsBTC kimi m…ônb…ôl…ôrd…ôn
- **üß† AI analizi**: H…ôr x…ôb…ôr √º√ß√ºn Google Gemini 2.0 Flash il…ô market t…ôsiri v…ô risk analizi
- **üåô G√ºnl√ºk AI √∂zet**: H…ôr gec…ô 00:05't…ô g√ºn√ºn …ôn vacib x…ôb…ôrl…ôrinin AI analizi
- **‚öôÔ∏è Kullanƒ±cƒ± ayarlarƒ±**: Anlƒ±k bildiriml…ôri v…ô g√ºnl√ºk √∂zeti ayrƒ± ayrƒ± a√ßƒ±p baƒülama
- **üíæ Kalƒ±cƒ± veri saklama**: Abun…ôlik v…ô ayar bilgil…ôri JSON fayllarƒ±nda saxlanƒ±r
- **üïê Az…ôrbaycan saatƒ±**: X…ôb…ôrl…ôrd…ô tarix v…ô saat AZT (Asia/Baku) zona saatƒ± il…ô g√∂st…ôrilir
- **üìä Sinxron arxitektura**: Stabil v…ô s√ºr…ôtli i≈ül…ôm…ô √º√ß√ºn sinxron kod strukturu
- **‚ö° Avtomatik yenil…ônm…ô**: 90 saniy…ôd…ô bir yeni x…ôb…ôr yoxlanmasƒ±
- **üë• ƒ∞ntellektual abun…ôlik sistemi**: ƒ∞stifad…ô√ßil…ôr bildirim tercihl…ôri ed…ô bil…ôrl…ôr


## ‚ú® Yeni √ñzellikler

### üéõÔ∏è Kullanƒ±cƒ± Bildirim Ayarlarƒ±
- **üîî Anlƒ±k X…ôb…ôrl…ôr**: Real-time kripto x…ôb…ôrl…ôrini a√ßƒ±p baƒülaya bil…ôrsiniz
- **üìÖ G√ºnl√ºk √ñzet**: Gece sabit saatd…ôki AI √∂zetini a√ßƒ±p baƒülaya bil…ôrsiniz  
- **‚öôÔ∏è Kolay Y√∂netim**: `/settings` komutu il…ô buton tabanlƒ± kontrol
- **üéØ Ki≈üiselle≈ütirme**: H…ôr istifad…ô√ßi √∂z tercihini yarada bil…ôr

### üåô G√ºnl√ºk AI √ñzet Sistemi
- **üïê Otomatik Zamanlama**: H…ôr gec…ô 00:05't…ô otomatik √∂zet
- **ü§ñ AI Analizi**: Son 24 saatƒ±n …ôn √∂nemli x…ôb…ôrl…ôrinin Gemini analizi
- **üìä Market Durumu**: G√ºnl√ºk trend analizi (Bullish/Bearish/Neytral)
- **üìã √ñzet Format**: √ñnemli x…ôb…ôrl…ôr, bazar analizi v…ô risk seviyy…ôsi
- **üîß Manuel Kontrol√º**: Adminl…ôr ist…ôdikl…ôri vaxt `/daily_summary` il…ô g√∂nder…ô bil…ôrl…ôr

### üíæ Kalƒ±cƒ± Veri Saklama Sistemi
- **üë• Abun…ôlik Verisi**: `subscribers.json` dosyasƒ±nda kalƒ±cƒ± saklama
- **‚öôÔ∏è Kullanƒ±cƒ± Ayarlarƒ±**: `user_settings.json` dosyasƒ±nda tercihl…ôr
- **üîÑ Bot Yeniden Ba≈ülatma**: Veriler kaybolmadan sistem devam eder
- **üõ°Ô∏è G√ºvenlik**: Hassas dosyalar `.gitignore` i√ßinde korunur



## üõ†Ô∏è Texniki X√ºsusiyy…ôtl…ôr

- **Python-telegram-bot v20.x**: Modern async handler d…ôst…ôyi
- **Dual Bot System**: H…ôm async (`telegram_bot.py`) h…ôm sync (`bot.py`) versiyalar
- **Windows/Linux uyƒüunluƒüu**: B√ºt√ºn platformlarda stabil √ßalƒ±≈üma
- **RSS …ôsaslƒ±**: API limitl…ôri olmadan x…ôb…ôr √ß…ôkilm…ôsi
- **JSON Data Persistence**: Kullanƒ±cƒ± verilerinin kalƒ±cƒ± saklanmasƒ±

## üöÄ Qura≈üdƒ±rma

### 1. Layih…ôni klonlayƒ±n
```bash
git clone https://github.com/your-username/crypto-news-bot.git
cd crypto-news-bot
```

### 2. Virtual environment yaradƒ±n
```bash
python -m venv .venv
# Windows
.venv\Scripts\activate
# Linux/Mac
source .venv/bin/activate
```

### 3. T…ôl…ôb olunan paketl…ôri y√ºkl…ôyin
```bash
pip install -r requirements.txt
```

### 4. Environment d…ôyi≈ü…ônl…ôrini t…ôyin edin

`env_example.txt` faylƒ±nƒ± `.env` adƒ± il…ô kopyalayƒ±n v…ô doldur√ºn:

```env
# Telegram Bot Configuration
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here

# Google Gemini Configuration  
GEMINI_API_KEY=your_gemini_api_key_here



# Admin User IDs (comma separated)
ADMIN_USER_IDS=123456789,987654321
```

### 5. API Key-l…ôrini …ôld…ô edin

#### Telegram Bot Token:
1. [@BotFather](https://t.me/botfather) il…ô …ôlaq…ô saxlayƒ±n
2. `/newbot` komandasƒ± il…ô yeni bot yaradƒ±n
3. Bot token-ƒ±nƒ± kopyalayƒ±n

#### Google Gemini API Key:
1. [Google AI Studio](https://makersuite.google.com/app/apikey) saytƒ±na daxil olun
2. Google hesabƒ±nƒ±zla giri≈ü edin
3. "Create API Key" d√ºym…ôsini basƒ±n

## üéÆ ƒ∞stifad…ô

### Modern Bot (Async) - T√∂vsiy…ô olunan:
```bash
python main.py  # telegram_bot.py istifad…ô edir
```

### Legacy Bot (Sync) - K√∂hn…ô versiyalar √º√ß√ºn:
```bash
# main.py'de bot.py import edin
python main.py
```

### Test etm…ôk:
```bash
python test_bot.py
```



## üìã Bot Komandalarƒ±

### üë§ ƒ∞stifad…ô√ßi Komandalarƒ±
- `/start` - Botu ba≈ülat v…ô tanƒ±tƒ±m men√ºs√º
- `/subscribe` - X…ôb…ôr abun…ôliyini aktivl…ô≈üdir
- `/unsubscribe` - Abun…ôliyi dayandƒ±r  
- `/settings` - **YENƒ∞!** Bildirim ayarlarƒ±nƒ± idar…ô et
- `/latest` - Son 3 x…ôb…ôri g√∂st…ôr
- `/status` - Bot statusu v…ô statistika
- `/help` - K√∂m…ôk m…ôlumatƒ±

### üîß Admin Komandalarƒ±
- `/admin` - Admin paneli v…ô statistikalar
- `/daily_summary` - **YENƒ∞!** Manuel g√ºnl√ºk √∂zet g√∂nd…ôr
- `/reset_news` - G√∂r√ºl…ôn x…ôb…ôr cache'ini temizl…ô

### üéõÔ∏è ƒ∞nline Butonlar
- **üì∞ Abun…ô ol** - Tez abun…ôlik
- **üìä Son x…ôb…ôrl…ôr** - Son x…ôb…ôrl…ôri g√∂st…ôr
- **‚öôÔ∏è Ayarlar** - Bildirim ayarlarƒ± men√ºs√º
- **‚ÑπÔ∏è K√∂m…ôk** - Yardƒ±m m…ôlumatlarƒ±

## üéØ Kullanƒ±cƒ± Ayarlarƒ± Sistemi

### ‚öôÔ∏è Ayarlar Men√ºs√º (`/settings`)
```
‚öôÔ∏è Bƒ∞LDƒ∞Rƒ∞M AYARLARI

üë§ ƒ∞stifad…ô√ßi: Ali
üìä Abun…ôlik statusu: Aktiv

üîî Anlƒ±k X…ôb…ôrl…ôr: üîî A√áIQ
   ‚Ä¢ Real-time kripto x…ôb…ôrl…ôri
   ‚Ä¢ G√ºn …ôrzind…ô g…ôl…ôn yenilikl…ôr

üìÖ G√ºnl√ºk √ñzet: üìÖ A√áIQ  
   ‚Ä¢ H…ôr gec…ô saat 00:05't…ô
   ‚Ä¢ AI il…ô hazƒ±rlanan g√ºn√ºn √∂zeti

üí° ƒ∞pucu: Anlƒ±k x…ôb…ôrl…ôri baƒülasanƒ±z da g√ºnl√ºk √∂zet almaƒüa davam ed…ô bil…ôrsiniz!
```

### üéÆ Kullanƒ±m Senaryalarƒ±
1. **üì± Sadece Anlƒ±k Haberler**: Anlƒ±k a√ßƒ±k, g√ºnl√ºk kapalƒ±
2. **üåô Sadece G√ºnl√ºk √ñzet**: Anlƒ±k kapalƒ±, g√ºnl√ºk a√ßƒ±k  
3. **üì∫ Tam Bilgilendirme**: ƒ∞kisi d…ô a√ßƒ±k
4. **üîï Ge√ßici Susturma**: ƒ∞kisi d…ô kapalƒ±

## üèóÔ∏è Layih…ô Strukturu

```
CryptoNewsBot/
‚îú‚îÄ‚îÄ main.py                   # Ana fayl - botu i≈ü…ô salƒ±r
‚îú‚îÄ‚îÄ telegram_bot.py           # Modern async bot (PTB v20.x) 
‚îú‚îÄ‚îÄ bot.py                    # Legacy sync bot (PTB v13.15)
‚îú‚îÄ‚îÄ config.py                 # Konfiqurasiya v…ô parametrl…ôr
‚îú‚îÄ‚îÄ news_fetcher.py           # X…ôb…ôr √ß…ôkm…ô sinifl…ôri
‚îú‚îÄ‚îÄ ai_analyzer.py            # AI analiz funksiyalarƒ±

‚îú‚îÄ‚îÄ test_bot.py               # Test skripti
‚îú‚îÄ‚îÄ requirements.txt          # Python paketl…ôri
‚îú‚îÄ‚îÄ env_example.txt           # Environment n√ºmun…ôsi
‚îú‚îÄ‚îÄ railway.toml              # Deploy konfig√ºrasyonu
‚îú‚îÄ‚îÄ runtime.txt               # Python versiyasƒ±
‚îú‚îÄ‚îÄ subscribers.json          # üíæ Abun…ô verisi (auto-generated)
‚îú‚îÄ‚îÄ user_settings.json        # üíæ Kullanƒ±cƒ± ayarlarƒ± (auto-generated)
‚îú‚îÄ‚îÄ seen_news.json            # üíæ G√∂r√ºl…ôn x…ôb…ôr cache (auto-generated)

‚îî‚îÄ‚îÄ README.md                # Bu fayl
```

## ‚öôÔ∏è Konfiqurasiya

`config.py` faylƒ±nda a≈üaƒüƒ±dakƒ± parametrl…ôri d…ôyi≈ü…ô bil…ôrsiniz:

```python
BOT_SETTINGS = {
    'check_interval': 90,       # Yoxlama intervalƒ± (saniy…ô) - 1.5 d…ôqiq…ô
    'max_news_per_check': 5,    # H…ôr yoxlamada max x…ôb…ôr sayƒ±
    'ai_analysis': True,        # AI analizi aktiv/deaktiv
    'send_to_channels': True    # Kanallara g√∂nd…ôrm…ô
}

AI_SETTINGS = {
    'model': 'gemini-2.0-flash',    # AI model
    'max_tokens': 200,              # Maksimum token sayƒ±
    'temperature': 0.7,             # Yaradƒ±cƒ±lƒ±q s…ôviyy…ôsi
    'analysis_prompt': "..."        # AI analiz prompt-u
}
```

## üìä X…ôb…ôr M…ônb…ôl…ôri

1. **CoinDesk**: RSS feed (`https://www.coindesk.com/arc/outboundfeeds/rss/`)
2. **The Block**: RSS feed (`https://www.theblock.co/rss.xml`)
3. **Crypto News**: RSS feed (`https://crypto.news/feed/`)
4. **NewsBTC**: RSS feed (`https://www.newsbtc.com/feed/`)

**Qeyd**: B√ºt√ºn m…ônb…ôl…ôr RSS vasit…ôsi il…ô √ß…ôkilir, API key t…ôl…ôb etmir.

## üß† AI Analizi

### üì∞ Anlƒ±k X…ôb…ôr Analizi
H…ôr x…ôb…ôr √º√ß√ºn Google Gemini 2.0 Flash modeli il…ô:
- **üî• Market T…ôsiri**: Bullish/Bearish/Neytral
- **üìä Risk S…ôviyy…ôsi**: A≈üaƒüƒ±/Orta/Y√ºks…ôk  
- **üí° Qƒ±sa Analiz**: 1-2 c√ºml…ô il…ô x…ôb…ôrin qiym…ôtl…ôndirilm…ôsi
- **üá¶üáø Az…ôrbaycan dilind…ô**: B√ºt√ºn analizl…ôr Az…ôrbaycan dilind…ô

### üåô G√ºnl√ºk √ñzet Analizi
```
üåô G√úNL√úK X∆èB∆èRL∆èRƒ∞N √ñZETƒ∞
üìÖ Tarix: 15.12.2024
üìä √úmumi Bazar Durumu: Bullish

üî• √ñN∆èMLƒ∞ X∆èB∆èRL∆èR:
‚Ä¢ Bitcoin 42000$ s…ôviyy…ôsini ke√ßdi
‚Ä¢ Ethereum'da yeni protokol g√ºncellemesi
‚Ä¢ BlackRock-un Bitcoin ETF ba≈üvurusu

üìà BAZAR ANALƒ∞Zƒ∞:
‚Ä¢ Market trend-i: Y√ºkselen
‚Ä¢ Risk seviyyesi: Orta
‚Ä¢ Yatƒ±rƒ±m tavsiyesi: Dikkatli iyimser

üéØ QISA N∆èTIC∆è:
Son 24 saatda pozitif geli≈ümeler g√∂zlemlendi.
```

## üïê Zaman Zona D…ôst…ôyi

- B√ºt√ºn x…ôb…ôr tarixl…ôri **Az…ôrbaycan saatƒ± (AZT)** il…ô g√∂st…ôrilir
- UTC-d…ôn avtomatik √ßevrilm…ô: `Asia/Baku` timezone
- Format: `DD.MM.YYYY HH:MM (AZT)`
- G√ºnl√ºk √∂zet: H…ôr gec…ô **00:05 AZT**

## üíæ Veri Saklama Sistemi

### üìÅ Otomatik Olu≈üan Dosyalar
- **`subscribers.json`**: Abun…ô olmu≈ü kullanƒ±cƒ±larƒ±n list…ôsi
- **`user_settings.json`**: H…ôr kullanƒ±cƒ±nƒ±n bildirim tercihleri
- **`seen_news.json`**: G√∂r√ºl…ôn x…ôb…ôr cache'i (dublikat √∂nleme)

### üõ°Ô∏è G√ºvenlik
T√ºm kullanƒ±cƒ± verisi dosyalarƒ± `.gitignore` i√ßind…ô korunur ve git'e commit edilmez.

### üîÑ Veri Formatlarƒ±
```json
// subscribers.json
{
  "subscribers": [123456789, 987654321],
  "last_updated": "2024-12-15T10:30:00",
  "total_count": 2
}

// user_settings.json  
{
  "123456789": {
    "instant_notifications": true,
    "daily_summary": true,
    "joined_date": "2024-12-15T10:30:00",
    "last_activity": "2024-12-15T10:30:00"
  }
}
```

## üì¶ Paket Versiyalarƒ±

```
# Modern Version (telegram_bot.py)
python-telegram-bot>=20.0   # Modern async d…ôst…ôk
asyncio                      # Async i≈ülemler

# Legacy Version (bot.py) 
python-telegram-bot==13.15  # Stabil sinxron d…ôst…ôk

# Ortak Paketler
requests==2.31.0             # HTTP sorƒüularƒ±
feedparser==6.0.10           # RSS parser
google-generativeai==0.3.2   # Gemini AI
beautifulsoup4==4.12.2       # HTML parser
python-dotenv==1.0.0         # Environment d…ôyi≈ü…ônl…ôri
APScheduler==3.6.3           # Job scheduler
pytz==2023.3                 # Timezone d…ôst…ôyi
```

## üìù Log v…ô Monitoring

- B√ºt√ºn f…ôaliyy…ôtl…ôr `crypto_bot.log` faylƒ±nda qeyd olunur
- Real-time konsol √ßƒ±xƒ±≈üƒ± m√∂vcuddur
- X…ôta hallarƒ±nda avtomatik recovery
- Job queue il…ô avtomatik x…ôb…ôr yoxlanmasƒ±
- Kullanƒ±cƒ± ayar deƒüi≈üiklikl…ôrinin loglanmasƒ±
- G√ºnl√ºk √∂zet g√∂nderim istatistikl…ôri

## üîß T…ôkmill…ô≈üdirm…ô

### Yeni x…ôb…ôr m…ônb…ôyi …ôlav…ô etm…ôk:

1. `config.py`-d…ô `NEWS_SOURCES`-…ô …ôlav…ô edin:
```python
'new_source': {
    'rss_url': 'https://example.com/rss.xml',
    'name': 'New Source'
}
```

2. `news_fetcher.py`-d…ô yeni fetch funksiyasƒ± yazƒ±n
3. `fetch_all_news()` metoduna daxil edin

### AI analiz modelini d…ôyi≈üm…ôk:

`config.py`-d…ô `AI_SETTINGS` b√∂lm…ôsind…ô model parametrl…ôrini d…ôyi≈üin:
```python
AI_SETTINGS = {
    'model': 'gemini-pro',  # v…ô ya ba≈üqa model
    'max_tokens': 300,
    'temperature': 0.5
}
```

### G√ºnl√ºk √∂zet saatini d…ôyi≈üm…ôk:

`telegram_bot.py` v…ô ya `bot.py`-d…ô job queue konfigurasiyasƒ±nƒ± d…ôyi≈üin:
```python
job_queue.run_daily(
    self.daily_summary_job,
    time=datetime.now().time().replace(hour=1, minute=0)  # 01:00'da
)
```

## üö® Probleml…ôr v…ô H…ôll…ôr

### Bot ba≈ülamƒ±r:
- Virtual environment-in aktivl…ô≈üdirildiyini yoxlayƒ±n
- `pip install -r requirements.txt` il…ô paketl…ôri yenid…ôn y√ºkl…ôyin
- `.env` faylƒ±nƒ±n m√∂vcud olduƒüunu t…ôsdiq edin

### Abun…ôlik verisi kaybolur:
- ‚úÖ **H…ôll edildi!** Artƒ±k `subscribers.json` faylƒ±nda kalƒ±cƒ± saklama
- Bot yeniden ba≈üladƒ±ldƒ±ƒüƒ±nda veriler otomatik y√ºkl…ônir

### X…ôb…ôr √ß…ôkilmir:
- ƒ∞nternet baƒülantƒ±sƒ±nƒ± yoxlayƒ±n
- RSS URL-l…ôrinin aktiv olduƒüunu t…ôsdiq edin
- `test_bot.py` il…ô komponentl…ôri test edin

### AI analizi i≈ül…ômir:
- Gemini API key-inin d√ºzg√ºn olduƒüunu yoxlayƒ±n
- API limitl…ôrini yoxlayƒ±n
- Fallback analiz sistemi avtomatik i≈ül…ôy…ôc…ôk

### G√ºnl√ºk √∂zet g…ôlmir:
- Kullanƒ±cƒ± ayarlarƒ±nda g√ºnl√ºk √∂zet a√ßƒ±k olduƒüunu yoxlayƒ±n (`/settings`)
- Bot timezone ayarlarƒ±nƒ± yoxlayƒ±n (AZT - Asia/Baku)
- Manuel test √º√ß√ºn `/daily_summary` admin komandasƒ± istifad…ô edin

### Bildiriml…ôr g…ôlmir:
- `/settings` komandasƒ± il…ô bildirimlerin a√ßƒ±k olduƒüunu yoxlayƒ±n
- Bot token-ƒ±nƒ±n d√ºzg√ºn olduƒüunu yoxlayƒ±n
- Botun istifad…ô√ßi t…ôr…ôfind…ôn bloklanmadƒ±ƒüƒ±nƒ± yoxlayƒ±n

## üÜï Son Yenilikl…ôr (v2.0)

- ‚úÖ **Kullanƒ±cƒ± Ayarlarƒ± Sistemi**: Bildiriml…ôri ayrƒ± ayrƒ± kontrol
- ‚úÖ **G√ºnl√ºk AI √ñzet**: H…ôr gec…ô otomatik √∂zet g√∂nderimi  
- ‚úÖ **Kalƒ±cƒ± Veri Saklama**: JSON dosyalarƒ±nda kullanƒ±cƒ± verilerinin korunmasƒ±
- ‚úÖ **Dual Bot System**: H…ôm async h…ôm sync versiyalar
- ‚úÖ **ƒ∞ntelligent Broadcasting**: Kullanƒ±cƒ± tercihl…ôrin…ô g√∂r…ô g√∂nderim
- ‚úÖ **Modern UI**: ƒ∞nline butonlar il…ô kolay y√∂netim
- ‚úÖ **Admin Panel Geli≈ütirmeleri**: Manual √∂zet v…ô detaylƒ± istatistikler
- ‚úÖ **PTB v20.x D…ôst…ôyi**: Modern async handler yapƒ±sƒ±
- ‚úÖ **Az…ôrbaycan saatƒ±**: AZT timezone d…ôst…ôyi
- ‚úÖ **Gemini 2.0 Flash**: Yeni AI model d…ôst…ôyi
- ‚úÖ **Windows/Linux uyƒüunluƒüu**: Cross-platform stabil √ßalƒ±≈üma

## üìä Sistem √ñzellikleri

### üéØ Performans
- **‚ö° Hƒ±zlƒ± Yanƒ±t**: ƒ∞nline butonlarla anƒ±nda ayar deƒüi≈üimi
- **üìä Akƒ±llƒ± Cache**: G√∂r√ºl…ôn x…ôb…ôrl…ôrin optimize edilmi≈ü saklanmasƒ±
- **üîÑ Rate Limiting**: Telegram API limitl…ôrin…ô uygun g√∂nderim
- **üíæ Memory Optimization**: Veri saklama i√ßin optimize edilmi≈ü JSON struktur

### üõ°Ô∏è G√ºvenlik
- **üîê Admin Kontrol√º**: Hassas komandlar i√ßin admin doƒürulamasƒ±
- **üö´ Data Protection**: Hassas dosyalar git'e commit edilmez
- **üîç Input Validation**: Kullanƒ±cƒ± giri≈ül…ôrinin doƒürulanmasƒ±
- **üìù Audit Logging**: T√ºm √∂nemli i≈ülemlerin loglanmasƒ±

## üìû D…ôst…ôk

Probleml…ôr √º√ß√ºn:
- GitHub Issues b√∂lm…ôsind…ô issue a√ßƒ±n
- Telegram: @davudov07
- Email: destek@cryptobot.az